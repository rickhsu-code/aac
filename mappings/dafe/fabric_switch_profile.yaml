---
mappings:
  - xls_sheet: fabric_switch_profile
    key_element: from_node_id
    elements:
      - name: name
        class: fabricLeafP
        attribute: name
        conditions:
          - type: is_parent_parent
      - name: description
        class: fabricLeafP
        attribute: descr
        conditions:
          - type: is_parent_parent
      - name: switch_selector
        class: fabricLeafS
        attribute: name
        conditions:
          - type: is_parent
      - name: switch_policy_group
        class: fabricRsLeNodePGrp
        attribute: tDn
        attribute_match_regex: '(?<=lenodepgrp-).*'
        conditions:
          - type: is_neighbor
      - name: from_node_id
        class: fabricNodeBlk
        attribute: from_
        conditions:
          - type: match_parent
            class: fabricLeafS
            match_regex: ''
            match_attribute: ''
      - name: to_node_id
        class: fabricNodeBlk
        attribute: to_
      - name: switch_profile_type
        value: leaf

  - xls_sheet: fabric_switch_profile
    key_element: from_node_id
    elements:
      - name: name
        class: fabricSpineP
        attribute: name
        conditions:
          - type: is_parent_parent
      - name: description
        class: fabricSpineP
        attribute: descr
        conditions:
          - type: is_parent_parent
      - name: switch_selector
        class: fabricSpineS
        attribute: name
        conditions:
          - type: is_parent
      - name: switch_policy_group
        class: fabricRsSpNodePGrp
        attribute: tDn
        attribute_match_regex: '(?<=spnodepgrp-).*'
        conditions:
          - type: is_neighbor
      - name: from_node_id
        class: fabricNodeBlk
        attribute: from_
        conditions:
          - type: match_parent
            class: fabricSpineS
            match_regex: ''
            match_attribute: ''
      - name: to_node_id
        class: fabricNodeBlk
        attribute: to_
      - name: switch_profile_type
        value: spine
