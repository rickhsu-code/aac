---
mappings:
  - xls_sheet: fex_interface_profile
    key_element: name
    elements:
      - name: name
        class: infraFexP
        attribute: name
        mandatory: true
        unique: true
      - name: interface_selector
        class: infraRsAccBaseGrp
        attribute: tDn
        attribute_match_regex: '(?<=/accportgrp-).*'
        mandatory: true
        conditions:
          - type: is_child
      - name: to_port
        class: infraPortBlk
        attribute: toPort
        conditions:
          - type: is_child
      - name: from_port
        class: infraPortBlk
        attribute: fromPort
        conditions:
          - type: is_child
      - name: slot_id
        class: infraPortBlk
        attribute: fromCard
        conditions:
          - type: is_child
      - name: int_pol_group_type
        value: Access

  - xls_sheet: fex_interface_profile
    key_element: name
    elements:
      - name: name
        class: infraFexP
        attribute: name
        mandatory: true
        unique: true
      - name: interface_selector
        class: infraRsAccBaseGrp
        attribute: tDn
        attribute_match_regex: '(?<=/accbundle-).*'
        mandatory: true
        conditions:
          - type: is_child
      - name: to_port
        class: infraPortBlk
        attribute: toPort
        conditions:
          - type: is_child
      - name: from_port
        class: infraPortBlk
        attribute: fromPort
        conditions:
          - type: is_child
      - name: slot_id
        class: infraPortBlk
        attribute: fromCard
        conditions:
          - type: is_child
