---
mappings:
  - xls_sheet: tacacs_provider
    key_element: host_or_ip
    elements:
      - name: auth_protocol
        class: aaaTacacsPlusProvider
        attribute: authProtocol
      - name: description
        class: aaaTacacsPlusProvider
        attribute: descr
      - name: key
        class: aaaTacacsPlusProvider
        attribute: key
      - name: monitor_server
        class: aaaTacacsPlusProvider
        attribute: monitoServer
      - name: monitor_user
        class: aaaTacacsPlusProvider
        attribute: monitoringUser
      - name: host_or_ip
        class: aaaTacacsPlusProvider
        attribute: name
        mandatory: true
      - name: port
        class: aaaTacacsPlusProvider
        attribute: port
      - name: retries
        class: aaaTacacsPlusProvider
        attribute: retries
      - name: time_out
        class: aaaTacacsPlusProvider
        attribute: timeout
      - name: management_epg
        class: aaaRsSecProvToEpg
        attribute: tDn
        attribute_match_regex: '(?<=mgmtp-default/).*(?=-default)'
        conditions:
          - type: is_child
