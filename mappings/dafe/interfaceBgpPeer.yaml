---
mappings:
  - xls_sheet: interfaceBgpPeer
    key_element: bgp_peer_ip
    elements:
      - name: tenant
        class: fvTenant
        attribute: name
        conditions:
          - type: is_parent_parent_parent_parent_parent
      - name: l3out
        class: l3extOut
        attribute: name
        conditions:
          - type: is_parent_parent_parent_parent
      - name: l3out_node_profile
        class: l3extLNodeP
        attribute: name
        conditions:
          - type: is_parent_parent_parent
      - name: name
        class: l3extLIfP
        attribute: name
        conditions:
          - type: is_parent_parent
      - name: path_type
        class: l3extRsPathL3OutAtt
        attribute: tDn
        map_attribute:
          - attribute_regex: '/protpaths-'
            mapped_value: vPC
          - attribute_regex: '/pathep-\[(?!eth)'
            mapped_value: PC
        default_value: ''
        mandatory: true
        conditions:
          - type: is_parent
      - name: pod_id
        class: l3extRsPathL3OutAtt
        attribute: tDn
        attribute_match_regex: '(?<=topology/pod-)\d+(?=/p)'
        conditions:
          - type: is_parent
      - name: left_node_id
        class: l3extRsPathL3OutAtt
        attribute: tDn
        attribute_match_regex: '(?<=paths-)\d+'
        conditions:
          - type: is_parent
      - name: right_node_id
        class: l3extRsPathL3OutAtt
        attribute: tDn
        attribute_match_regex: '(?<=\d-)\d+(?=/pathep-\[)'
        conditions:
          - type: is_parent
      - name: int_pol_group
        class: l3extRsPathL3OutAtt
        attribute: tDn
        attribute_match_regex: '(?<=pathep-\[).*(?=\])'
        conditions:
          - type: is_parent
      - name: bgp_peer_ip
        class: bgpPeerP
        attribute: addr
        mandatory: true
      - name: bgp_peer_name
        class: bgpPeerP
        attribute: descr
      - name: use_bfd
        class: bgpPeerP
        attribute: peerCtrl
        map_attribute:
          - attribute_regex: 'bfd'
            mapped_value: 'yes'
        default_value: 'no'
      - name: bgp_peer_as
        class: bgpAsP
        attribute: asn
        conditions:
          - type: is_child

  - xls_sheet: interfaceBgpPeer
    key_element: bgp_peer_ip
    elements:
      - name: tenant
        class: fvTenant
        attribute: name
        conditions:
          - type: is_parent_parent_parent_parent_parent
      - name: l3out
        class: l3extOut
        attribute: name
        conditions:
          - type: is_parent_parent_parent_parent
      - name: l3out_node_profile
        class: l3extLNodeP
        attribute: name
        conditions:
          - type: is_parent_parent_parent
      - name: name
        class: l3extLIfP
        attribute: name
        conditions:
          - type: is_parent_parent
      - name: path_type
        class: l3extRsPathL3OutAtt
        attribute: tDn
        map_attribute:
          - attribute_regex: '/pathep-\[eth'
            mapped_value: Access
        default_value: ''
        mandatory: true
        conditions:
          - type: is_parent
      - name: pod_id
        class: l3extRsPathL3OutAtt
        attribute: tDn
        attribute_match_regex: '(?<=topology/pod-)\d+(?=/p)'
        conditions:
          - type: is_parent
      - name: left_node_id
        class: l3extRsPathL3OutAtt
        attribute: tDn
        attribute_match_regex: '(?<=paths-)\d+'
        conditions:
          - type: is_parent
      - name: port_id
        class: l3extRsPathL3OutAtt
        attribute: tDn
        attribute_match_regex: '(?<=pathep-\[eth).*(?=\])'
        conditions:
          - type: is_parent
      - name: bgp_peer_ip
        class: bgpPeerP
        attribute: addr
        mandatory: true
      - name: bgp_peer_name
        class: bgpPeerP
        attribute: descr
      - name: use_bfd
        class: bgpPeerP
        attribute: peerCtrl
        map_attribute:
          - attribute_regex: 'bfd'
            mapped_value: 'yes'
        default_value: 'no'
      - name: bgp_peer_as
        class: bgpAsP
        attribute: asn
        conditions:
          - type: is_child
