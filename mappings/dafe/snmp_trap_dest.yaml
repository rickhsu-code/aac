---
mappings:
  - xls_sheet: snmp_trap_dest
    key_element: snmp_trap_dest_host_or_ip
    elements:
      - name: description
        class: snmpGroup
        attribute: descr
        conditions:
          - type: is_parent
      - name: name
        class: snmpGroup
        attribute: name
        conditions:
          - type: is_parent
      - name: snmp_trap_dest_host_or_ip
        class: snmpTrapDest
        attribute: host
        mandatory: true
      - name: port
        class: snmpTrapDest
        attribute: port
      - name: community_or_user
        class: snmpTrapDest
        attribute: secName
      - name: v3_sec_level
        class: snmpTrapDest
        attribute: v3SecLvl
      - name: version
        class: snmpTrapDest
        attribute: ver
      - name: management_epg
        class: fileRsARemoteHostToEpg
        attribute: tDn
        attribute_match_regex: '(?<=mgmtp-default/).*(?=-default)'
        conditions:
          - type: is_child
