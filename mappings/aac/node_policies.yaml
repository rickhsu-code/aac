---
files:
  - name: node_policies.yaml
    elements:
      - name: apic
        type: dict
        elements:
          - name: node_policies
            type: dict
            elements:
              - name: inb_endpoint_group
                class: dnsRsProfileToEpg
                attribute: tDn
                attribute_match_regex: '(?<=mgmtp-default/inb-).*'
              - name: inb_endpoint_group
                class: fileRsARemoteHostToEpg
                attribute: tDn
                attribute_match_regex: '(?<=mgmtp-default/inb-).*'
              - name: inb_endpoint_group
                class: snmpRsEpg
                attribute: tDn
                attribute_match_regex: '(?<=mgmtp-default/inb-).*'
              - name: inb_endpoint_group
                class: vmmRsMgmtEPg
                attribute: tDn
                attribute_match_regex: '(?<=mgmtp-default/inb-).*'
              - name: inb_endpoint_group
                class: aaaRsSecProvToEpg
                attribute: tDn
                attribute_match_regex: '(?<=mgmtp-default/inb-).*'
              - name: inb_endpoint_group
                class: datetimeRsNtpProvToEpg
                attribute: tDn
                attribute_match_regex: '(?<=mgmtp-default/inb-).*'

              - name: oob_endpoint_group
                class: dnsRsProfileToEpg
                attribute: tDn
                attribute_match_regex: '(?<=mgmtp-default/oob-).*'
              - name: oob_endpoint_group
                class: fileRsARemoteHostToEpg
                attribute: tDn
                attribute_match_regex: '(?<=mgmtp-default/oob-).*'
              - name: oob_endpoint_group
                class: snmpRsEpg
                attribute: tDn
                attribute_match_regex: '(?<=mgmtp-default/oob-).*'
              - name: oob_endpoint_group
                class: vmmRsMgmtEPg
                attribute: tDn
                attribute_match_regex: '(?<=mgmtp-default/oob-).*'
              - name: oob_endpoint_group
                class: aaaRsSecProvToEpg
                attribute: tDn
                attribute_match_regex: '(?<=mgmtp-default/oob-).*'
              - name: oob_endpoint_group
                class: datetimeRsNtpProvToEpg
                attribute: tDn
                attribute_match_regex: '(?<=mgmtp-default/oob-).*'

              - name: update_groups
                type: list_dict
                key_element: name
                class: maintMaintGrp
                elements:
                  - name: name
                    type: string
                    attribute: name

              - name: vpc_groups
                type: dict
                class: fabricProtPol
                ignore_filter: True
                elements:
                  - name: mode
                    attribute: pairT
                  - name: groups
                    type: list_dict
                    key_element: name
                    class: fabricExplicitGEp
                    elements:
                      - name: id
                        type: int
                        attribute: id
                      - name: name
                        type: string
                        attribute: name
                      - name: switch_1
                        type: int
                        class: fabricNodePEp
                        index: 1
                        attribute: id
                      - name: switch_2
                        type: int
                        class: fabricNodePEp
                        index: 2
                        attribute: id
                      - name: policy
                        class: fabricRsVpcInstPol
                        attribute: tnVpcInstPolName

              - name: nodes
                type: list_dict
                key_element: id
                class: fabricNodeIdentP
                elements:
                  - name: id
                    type: int
                    attribute: nodeId
                    key: true
                  - name: pod
                    type: int
                    attribute: podId
                  - name: role
                    class: infraNodeBlk
                    query_scope: global
                    attribute: from_
                    default_value: ''
                    conditions:
                      - type: match_parent
                        class: infraLeafS
                        match_regex: ''
                        match_attribute: ''
                      - type: match
                        match_regex: '%%key%%'
                        match_attribute: 'from_'
                    map_attribute:
                      - attribute_regex: ''
                        mapped_value: 'leaf'
                  - name: role
                    class: infraNodeBlk
                    query_scope: global
                    attribute: to_
                    default_value: ''
                    conditions:
                      - type: match_parent
                        class: infraLeafS
                        match_regex: ''
                        match_attribute: ''
                      - type: match
                        match_regex: '%%key%%'
                        match_attribute: 'to_'
                    map_attribute:
                      - attribute_regex: ''
                        mapped_value: 'leaf'
                  - name: role
                    class: infraNodeBlk
                    query_scope: global
                    attribute: from_
                    default_value: ''
                    conditions:
                      - type: match_parent
                        class: infraSpineS
                        match_regex: ''
                        match_attribute: ''
                      - type: match
                        match_regex: '%%key%%'
                        match_attribute: 'from_'
                    map_attribute:
                      - attribute_regex: ''
                        mapped_value: 'spine'
                  - name: role
                    class: infraNodeBlk
                    query_scope: global
                    attribute: to_
                    default_value: ''
                    conditions:
                      - type: match_parent
                        class: infraSpineS
                        match_regex: ''
                        match_attribute: ''
                      - type: match
                        match_regex: '%%key%%'
                        match_attribute: 'to_'
                    map_attribute:
                      - attribute_regex: ''
                        mapped_value: 'spine'
                  - name: serial_number
                    attribute: serial
                  - name: name
                    type: string
                    attribute: name
                  - name: oob_address
                    class: mgmtRsOoBStNode
                    query_scope: global
                    attribute: addr
                    conditions:
                      - type: match
                        match_attribute: tDn
                        match_regex: '(?<=/node-)%%key%%'
                  - name: oob_gateway
                    class: mgmtRsOoBStNode
                    query_scope: global
                    attribute: gw
                    conditions:
                      - type: match
                        match_attribute: tDn
                        match_regex: '(?<=/node-)%%key%%'
                  - name: inb_address
                    class: mgmtRsInBStNode
                    query_scope: global
                    attribute: addr
                    conditions:
                      - type: match
                        match_attribute: tDn
                        match_regex: '(?<=/node-)%%key%%'
                  - name: inb_gateway
                    class: mgmtRsInBStNode
                    query_scope: global
                    attribute: gw
                    conditions:
                      - type: match
                        match_attribute: tDn
                        match_regex: '(?<=/node-)%%key%%'
                  - name: update_group
                    class: maintMaintGrp
                    query_scope: global
                    attribute: name
                    conditions:
                      - type: match_child
                        class: fabricNodeBlk
                        match_attribute: from_
                        match_regex: '%%key%%'
                  - name: update_group
                    class: maintMaintGrp
                    query_scope: global
                    attribute: name
                    conditions:
                      - type: match_child
                        class: fabricNodeBlk
                        match_attribute: to_
                        match_regex: '%%key%%'
